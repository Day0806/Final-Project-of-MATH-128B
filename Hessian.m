function output = Hessian( x, y, beta )
storage = zeros(length(beta), length(beta));
for i = 1 : length(x)
storage = storage +  [                                                                                                         2*exp(-2*beta(2)*x(i)),        - x(i)*exp(-beta(2)*x(i))*(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2) - 2*y(i) + 2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2) + 2*beta(1)*exp(-beta(2)*x(i))) - 2*beta(1)*x(i)*exp(-2*beta(2)*x(i)),                                                                                                                                                 2*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-beta(2)*x(i)),                                                                                                                                                                                                                                                                                       -(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-beta(2)*x(i))*(2*beta(4) - 2*x(i)))/beta(5)^2,                                                                                                                                                                                                                                                                                          (4*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-beta(2)*x(i))*(beta(4) - x(i))^2)/beta(5)^3,                                                                                                                                                 2*exp(-(beta(7) - x(i))^2/beta(8)^2)*exp(-beta(2)*x(i)),                                                                                                                                                                                                                                                                                       -(2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2)*exp(-beta(2)*x(i))*(2*beta(7) - 2*x(i)))/beta(8)^2,                                                                                                                                                                                                                                                                                          (4*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2)*exp(-beta(2)*x(i))*(beta(7) - x(i))^2)/beta(8)^3;
 - x(i)*exp(-beta(2)*x(i))*(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2) - 2*y(i) + 2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2) + 2*beta(1)*exp(-beta(2)*x(i))) - 2*beta(1)*x(i)*exp(-2*beta(2)*x(i)), 2*beta(1)^2*x(i)^2*exp(-2*beta(2)*x(i)) + beta(1)*x(i)^2*exp(-beta(2)*x(i))*(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2) - 2*y(i) + 2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2) + 2*beta(1)*exp(-beta(2)*x(i))),                                                                                                                                           -2*beta(1)*x(i)*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-beta(2)*x(i)),                                                                                                                                                                                                                                                                                   (2*beta(1)*beta(3)*x(i)*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-beta(2)*x(i))*(2*beta(4) - 2*x(i)))/beta(5)^2,                                                                                                                                                                                                                                                                                    -(4*beta(1)*beta(3)*x(i)*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-beta(2)*x(i))*(beta(4) - x(i))^2)/beta(5)^3,                                                                                                                                           -2*beta(1)*x(i)*exp(-(beta(7) - x(i))^2/beta(8)^2)*exp(-beta(2)*x(i)),                                                                                                                                                                                                                                                                                   (2*beta(1)*beta(6)*x(i)*exp(-(beta(7) - x(i))^2/beta(8)^2)*exp(-beta(2)*x(i))*(2*beta(7) - 2*x(i)))/beta(8)^2,                                                                                                                                                                                                                                                                                    -(4*beta(1)*beta(6)*x(i)*exp(-(beta(7) - x(i))^2/beta(8)^2)*exp(-beta(2)*x(i))*(beta(7) - x(i))^2)/beta(8)^3;
                                                                                     2*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-beta(2)*x(i)),                                                                                      -2*beta(1)*x(i)*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-beta(2)*x(i)),                                                                                                                                                        2*exp(-(2*(beta(4) - x(i))^2)/beta(5)^2),                                                                                                                                                               - (exp(-(beta(4) - x(i))^2/beta(5)^2)*(2*beta(4) - 2*x(i))*(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2) - 2*y(i) + 2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2) + 2*beta(1)*exp(-beta(2)*x(i))))/beta(5)^2 - (2*beta(3)*exp(-(2*(beta(4) - x(i))^2)/beta(5)^2)*(2*beta(4) - 2*x(i)))/beta(5)^2,                                                                                                                                                                   (2*exp(-(beta(4) - x(i))^2/beta(5)^2)*(beta(4) - x(i))^2*(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2) - 2*y(i) + 2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2) + 2*beta(1)*exp(-beta(2)*x(i))))/beta(5)^3 + (4*beta(3)*exp(-(2*(beta(4) - x(i))^2)/beta(5)^2)*(beta(4) - x(i))^2)/beta(5)^3,                                                                                                                                      2*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-(beta(7) - x(i))^2/beta(8)^2),                                                                                                                                                                                                                                                                            -(2*beta(6)*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-(beta(7) - x(i))^2/beta(8)^2)*(2*beta(7) - 2*x(i)))/beta(8)^2,                                                                                                                                                                                                                                                                               (4*beta(6)*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-(beta(7) - x(i))^2/beta(8)^2)*(beta(7) - x(i))^2)/beta(8)^3;
                                                             -(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-beta(2)*x(i))*(2*beta(4) - 2*x(i)))/beta(5)^2,                                                                (2*beta(1)*beta(3)*x(i)*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-beta(2)*x(i))*(2*beta(4) - 2*x(i)))/beta(5)^2, - (exp(-(beta(4) - x(i))^2/beta(5)^2)*(2*beta(4) - 2*x(i))*(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2) - 2*y(i) + 2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2) + 2*beta(1)*exp(-beta(2)*x(i))))/beta(5)^2 - (2*beta(3)*exp(-(2*(beta(4) - x(i))^2)/beta(5)^2)*(2*beta(4) - 2*x(i)))/beta(5)^2,                                  (2*beta(3)^2*exp(-(2*(beta(4) - x(i))^2)/beta(5)^2)*(2*beta(4) - 2*x(i))^2)/beta(5)^4 - (2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2)*(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2) - 2*y(i) + 2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2) + 2*beta(1)*exp(-beta(2)*x(i))))/beta(5)^2 + (beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2)*(2*beta(4) - 2*x(i))^2*(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2) - 2*y(i) + 2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2) + 2*beta(1)*exp(-beta(2)*x(i))))/beta(5)^4, (2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2)*(2*beta(4) - 2*x(i))*(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2) - 2*y(i) + 2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2) + 2*beta(1)*exp(-beta(2)*x(i))))/beta(5)^3 - (4*beta(3)^2*exp(-(2*(beta(4) - x(i))^2)/beta(5)^2)*(beta(4) - x(i))^2*(2*beta(4) - 2*x(i)))/beta(5)^5 - (2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2)*(beta(4) - x(i))^2*(2*beta(4) - 2*x(i))*(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2) - 2*y(i) + 2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2) + 2*beta(1)*exp(-beta(2)*x(i))))/beta(5)^5,                                                                                                              -(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-(beta(7) - x(i))^2/beta(8)^2)*(2*beta(4) - 2*x(i)))/beta(5)^2,                                                                                                                                                                                                                                                      (2*beta(3)*beta(6)*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-(beta(7) - x(i))^2/beta(8)^2)*(2*beta(4) - 2*x(i))*(2*beta(7) - 2*x(i)))/(beta(5)^2*beta(8)^2),                                                                                                                                                                                                                                                       -(4*beta(3)*beta(6)*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-(beta(7) - x(i))^2/beta(8)^2)*(beta(7) - x(i))^2*(2*beta(4) - 2*x(i)))/(beta(5)^2*beta(8)^3);
                                                                (4*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-beta(2)*x(i))*(beta(4) - x(i))^2)/beta(5)^3,                                                                 -(4*beta(1)*beta(3)*x(i)*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-beta(2)*x(i))*(beta(4) - x(i))^2)/beta(5)^3,     (2*exp(-(beta(4) - x(i))^2/beta(5)^2)*(beta(4) - x(i))^2*(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2) - 2*y(i) + 2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2) + 2*beta(1)*exp(-beta(2)*x(i))))/beta(5)^3 + (4*beta(3)*exp(-(2*(beta(4) - x(i))^2)/beta(5)^2)*(beta(4) - x(i))^2)/beta(5)^3, (2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2)*(2*beta(4) - 2*x(i))*(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2) - 2*y(i) + 2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2) + 2*beta(1)*exp(-beta(2)*x(i))))/beta(5)^3 - (4*beta(3)^2*exp(-(2*(beta(4) - x(i))^2)/beta(5)^2)*(beta(4) - x(i))^2*(2*beta(4) - 2*x(i)))/beta(5)^5 - (2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2)*(beta(4) - x(i))^2*(2*beta(4) - 2*x(i))*(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2) - 2*y(i) + 2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2) + 2*beta(1)*exp(-beta(2)*x(i))))/beta(5)^5,                             (8*beta(3)^2*exp(-(2*(beta(4) - x(i))^2)/beta(5)^2)*(beta(4) - x(i))^4)/beta(5)^6 - (6*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2)*(beta(4) - x(i))^2*(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2) - 2*y(i) + 2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2) + 2*beta(1)*exp(-beta(2)*x(i))))/beta(5)^4 + (4*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2)*(beta(4) - x(i))^4*(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2) - 2*y(i) + 2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2) + 2*beta(1)*exp(-beta(2)*x(i))))/beta(5)^6,                                                                                                                 (4*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-(beta(7) - x(i))^2/beta(8)^2)*(beta(4) - x(i))^2)/beta(5)^3,                                                                                                                                                                                                                                                       -(4*beta(3)*beta(6)*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-(beta(7) - x(i))^2/beta(8)^2)*(beta(4) - x(i))^2*(2*beta(7) - 2*x(i)))/(beta(5)^3*beta(8)^2),                                                                                                                                                                                                                                                          (8*beta(3)*beta(6)*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-(beta(7) - x(i))^2/beta(8)^2)*(beta(4) - x(i))^2*(beta(7) - x(i))^2)/(beta(5)^3*beta(8)^3);
                                                                                     2*exp(-(beta(7) - x(i))^2/beta(8)^2)*exp(-beta(2)*x(i)),                                                                                      -2*beta(1)*x(i)*exp(-(beta(7) - x(i))^2/beta(8)^2)*exp(-beta(2)*x(i)),                                                                                                                                      2*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-(beta(7) - x(i))^2/beta(8)^2),                                                                                                                                                                                                                                                                            -(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-(beta(7) - x(i))^2/beta(8)^2)*(2*beta(4) - 2*x(i)))/beta(5)^2,                                                                                                                                                                                                                                                                               (4*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-(beta(7) - x(i))^2/beta(8)^2)*(beta(4) - x(i))^2)/beta(5)^3,                                                                                                                                                        2*exp(-(2*(beta(7) - x(i))^2)/beta(8)^2),                                                                                                                                                               - (exp(-(beta(7) - x(i))^2/beta(8)^2)*(2*beta(7) - 2*x(i))*(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2) - 2*y(i) + 2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2) + 2*beta(1)*exp(-beta(2)*x(i))))/beta(8)^2 - (2*beta(6)*exp(-(2*(beta(7) - x(i))^2)/beta(8)^2)*(2*beta(7) - 2*x(i)))/beta(8)^2,                                                                                                                                                                   (2*exp(-(beta(7) - x(i))^2/beta(8)^2)*(beta(7) - x(i))^2*(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2) - 2*y(i) + 2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2) + 2*beta(1)*exp(-beta(2)*x(i))))/beta(8)^3 + (4*beta(6)*exp(-(2*(beta(7) - x(i))^2)/beta(8)^2)*(beta(7) - x(i))^2)/beta(8)^3;
                                                             -(2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2)*exp(-beta(2)*x(i))*(2*beta(7) - 2*x(i)))/beta(8)^2,                                                                (2*beta(1)*beta(6)*x(i)*exp(-(beta(7) - x(i))^2/beta(8)^2)*exp(-beta(2)*x(i))*(2*beta(7) - 2*x(i)))/beta(8)^2,                                                                                                              -(2*beta(6)*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-(beta(7) - x(i))^2/beta(8)^2)*(2*beta(7) - 2*x(i)))/beta(8)^2,                                                                                                                                                                                                                                                      (2*beta(3)*beta(6)*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-(beta(7) - x(i))^2/beta(8)^2)*(2*beta(4) - 2*x(i))*(2*beta(7) - 2*x(i)))/(beta(5)^2*beta(8)^2),                                                                                                                                                                                                                                                       -(4*beta(3)*beta(6)*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-(beta(7) - x(i))^2/beta(8)^2)*(beta(4) - x(i))^2*(2*beta(7) - 2*x(i)))/(beta(5)^3*beta(8)^2), - (exp(-(beta(7) - x(i))^2/beta(8)^2)*(2*beta(7) - 2*x(i))*(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2) - 2*y(i) + 2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2) + 2*beta(1)*exp(-beta(2)*x(i))))/beta(8)^2 - (2*beta(6)*exp(-(2*(beta(7) - x(i))^2)/beta(8)^2)*(2*beta(7) - 2*x(i)))/beta(8)^2,                                  (2*beta(6)^2*exp(-(2*(beta(7) - x(i))^2)/beta(8)^2)*(2*beta(7) - 2*x(i))^2)/beta(8)^4 - (2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2)*(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2) - 2*y(i) + 2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2) + 2*beta(1)*exp(-beta(2)*x(i))))/beta(8)^2 + (beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2)*(2*beta(7) - 2*x(i))^2*(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2) - 2*y(i) + 2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2) + 2*beta(1)*exp(-beta(2)*x(i))))/beta(8)^4, (2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2)*(2*beta(7) - 2*x(i))*(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2) - 2*y(i) + 2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2) + 2*beta(1)*exp(-beta(2)*x(i))))/beta(8)^3 - (4*beta(6)^2*exp(-(2*(beta(7) - x(i))^2)/beta(8)^2)*(beta(7) - x(i))^2*(2*beta(7) - 2*x(i)))/beta(8)^5 - (2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2)*(beta(7) - x(i))^2*(2*beta(7) - 2*x(i))*(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2) - 2*y(i) + 2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2) + 2*beta(1)*exp(-beta(2)*x(i))))/beta(8)^5;
                                                                (4*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2)*exp(-beta(2)*x(i))*(beta(7) - x(i))^2)/beta(8)^3,                                                                 -(4*beta(1)*beta(6)*x(i)*exp(-(beta(7) - x(i))^2/beta(8)^2)*exp(-beta(2)*x(i))*(beta(7) - x(i))^2)/beta(8)^3,                                                                                                                 (4*beta(6)*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-(beta(7) - x(i))^2/beta(8)^2)*(beta(7) - x(i))^2)/beta(8)^3,                                                                                                                                                                                                                                                       -(4*beta(3)*beta(6)*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-(beta(7) - x(i))^2/beta(8)^2)*(beta(7) - x(i))^2*(2*beta(4) - 2*x(i)))/(beta(5)^2*beta(8)^3),                                                                                                                                                                                                                                                          (8*beta(3)*beta(6)*exp(-(beta(4) - x(i))^2/beta(5)^2)*exp(-(beta(7) - x(i))^2/beta(8)^2)*(beta(4) - x(i))^2*(beta(7) - x(i))^2)/(beta(5)^3*beta(8)^3),     (2*exp(-(beta(7) - x(i))^2/beta(8)^2)*(beta(7) - x(i))^2*(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2) - 2*y(i) + 2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2) + 2*beta(1)*exp(-beta(2)*x(i))))/beta(8)^3 + (4*beta(6)*exp(-(2*(beta(7) - x(i))^2)/beta(8)^2)*(beta(7) - x(i))^2)/beta(8)^3, (2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2)*(2*beta(7) - 2*x(i))*(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2) - 2*y(i) + 2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2) + 2*beta(1)*exp(-beta(2)*x(i))))/beta(8)^3 - (4*beta(6)^2*exp(-(2*(beta(7) - x(i))^2)/beta(8)^2)*(beta(7) - x(i))^2*(2*beta(7) - 2*x(i)))/beta(8)^5 - (2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2)*(beta(7) - x(i))^2*(2*beta(7) - 2*x(i))*(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2) - 2*y(i) + 2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2) + 2*beta(1)*exp(-beta(2)*x(i))))/beta(8)^5,                             (8*beta(6)^2*exp(-(2*(beta(7) - x(i))^2)/beta(8)^2)*(beta(7) - x(i))^4)/beta(8)^6 - (6*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2)*(beta(7) - x(i))^2*(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2) - 2*y(i) + 2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2) + 2*beta(1)*exp(-beta(2)*x(i))))/beta(8)^4 + (4*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2)*(beta(7) - x(i))^4*(2*beta(3)*exp(-(beta(4) - x(i))^2/beta(5)^2) - 2*y(i) + 2*beta(6)*exp(-(beta(7) - x(i))^2/beta(8)^2) + 2*beta(1)*exp(-beta(2)*x(i))))/beta(8)^6;];
end
output = storage;
end

